<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="renderer" content="webkit"/>
  <meta name="apple-touch-fullscreen" content="yes"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>签名算法</title>
  <link rel="stylesheet" type="text/css" href="apidoc.css"/></head>
<body>
<div mdin class="catalog">
<ul>
  <li>
  <p><a href="index.html">系统介绍</a></p></li>
  <li>
  <p><a href="接口授权说明.html">接口授权说明</a></p></li>
  <li><a href="签名算法.html">签名算法</a></li>
</ul>
<hr/>
<ul>
  <li><a href="手机APP支付.html">1 手机APP支付</a>
    <ul>
      <li><a href="手机APP支付.html#1.1我的钱包">1.1 我的钱包</a></li>
      <li><a href="手机APP支付.html#1.2充值">1.2 充值</a></li>
      <li><a href="手机APP支付.html#1.3alipay客户端结果验签">1.3 alipay客户端结果验签</a></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="手机APP公共.html">2 手机APP公共</a>
    <ul>
      <li><a href="手机APP公共.html#2.1省市区数据">2.1 省市区数据</a></li>
      <li><a href="手机APP公共.html#2.2配送范围">2.2 配送范围</a></li>
      <li><a href="手机APP公共.html#2.3收货点">2.3 收货点</a></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="手机APP订单.html">3 手机APP订单</a>
    <ul>
      <li><a href="手机APP订单.html#3.1我的订单">3.1 我的订单</a></li>
      <li><a href="手机APP订单.html#3.2个人订单详情">3.2 个人订单详情</a></li>
      <li><a href="手机APP订单.html#3.3物流状态">3.3 物流状态</a></li>
      <li><a href="手机APP订单.html#3.4订单轨迹">3.4 订单轨迹</a></li>
      <li><a href="手机APP订单.html#3.5删除订单">3.5 删除订单</a></li>
      <li><a href="手机APP订单.html#3.6我要投诉">3.6 我要投诉</a></li>
      <li><a href="手机APP订单.html#3.7我的投诉">3.7 我的投诉</a></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="手机APP用户.html">4 手机APP用户</a>
    <ul>
      <li><a href="手机APP用户.html#4.1登录">4.1 登录</a></li>
      <li><a href="手机APP用户.html#4.2注册/绑定新手机号发送验证码">4.2 注册/绑定新手机号发送验证码</a></li>
      <li><a href="手机APP用户.html#4.3找回密码发送验证码">4.3 找回密码发送验证码</a></li>
      <li><a href="手机APP用户.html#4.4验证验证码">4.4 验证验证码</a></li>
      <li><a href="手机APP用户.html#4.5注册">4.5 注册</a></li>
      <li><a href="手机APP用户.html#4.6查看个人详情">4.6 查看个人详情</a></li>
      <li><a href="手机APP用户.html#4.7更新资料">4.7 更新资料</a></li>
      <li><a href="手机APP用户.html#4.8修改手机号">4.8 修改手机号</a></li>
      <li><a href="手机APP用户.html#4.9修改密码">4.9 修改密码</a></li>
      <li><a href="手机APP用户.html#4.10找回密码">4.10 找回密码</a></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="测试时所用接口.html">5 测试时所用接口</a>
    <ul>
      <li>
      <p><a href="测试时所用接口.html#5.1生成测试验证码">5.1 生成测试验证码</a></p></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="手持端基本.html">6 手持端基本</a>
    <ul>
      <li>
      <p><a href="手持端基本.html#6.1检查版本号">6.1 检查版本号</a></p></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="手持端用户.html">7 手持端用户</a>
    <ul>
      <li><a href="手持端用户.html#7.1登录">7.1 登录</a></li>
      <li><a href="手持端用户.html#7.2登出">7.2 登出</a></li>
      <li><a href="手持端用户.html#7.3查看个人信息">7.3 查看个人信息</a></li>
      <li><a href="手持端用户.html#7.4修改个人信息">7.4 修改个人信息</a></li>
      <li><a href="手持端用户.html#7.5修改密码">7.5 修改密码</a></li>
    </ul>
  </li>
</ul>
<hr/>
<ul>
  <li><a href="手持端订单.html">8 手持端订单</a>
    <ul>
      <li><a href="手持端订单.html#8.1当前订单">8.1 当前订单</a></li>
      <li><a href="手持端订单.html#8.2历史订单">8.2 历史订单</a></li>
      <li><a href="手持端订单.html#8.3订单详情">8.3 订单详情</a></li>
      <li><a href="手持端订单.html#8.4订单状态">8.4 订单状态</a></li>
      <li><a href="手持端订单.html#8.5订单号查单">8.5 订单号查单</a></li>
      <li><a href="手持端订单.html#8.6订单号查位置">8.6 订单号查位置</a></li>
      <li><a href="手持端订单.html#8.7订单接单">8.7 订单接单</a></li>
      <li><a href="手持端订单.html#8.8到货处理">8.8 到货处理</a></li>
      <li><a href="手持端订单.html#8.9更新订单轨迹">8.9 更新订单轨迹</a></li>
    </ul>
  </li>
</ul>
<hr/></div>
<div mdin class="content">
<h2><a href="#签名算法" name="签名算法">签名算法</a></h2>
<ul>
  <li>
  <p>筛选<br/>获取所有请求参数，不包括字节类型参数，如文件、字节流，不包括签名参数“sign”。</p></li>
  <li>
  <p>排序<br/>将筛选的参数按照参数名第一个字符的键值ASCII码递增排序（字母升序排序），如果遇到相同字符则按照第二个字符的键值ASCII码递增排序，以此类推。如果遇到一个参数多个值（如：q=1&amp;q=2）则转换为一个值为英文逗号（,）分隔的参数（如：q=1,2）</p></li>
  <li>
  <p>拼接<br/>将排序后的参数与其对应值，组合成“参数=参数值”的格式，加入当前时间毫秒数(从1970年1月1日（UTC/GMT的午夜）开始所经过的毫秒数)，并且把这些参数用&amp;字符连接起来。此时生成的字符串为待签名字符串。<br/>例如下面的请求示例，参数值都是示例，开发者参考格式即可：</p></li>
</ul>
<pre><code class="html">    REQUEST URL: https://www.xxx.com?page=0&amp;size=25&amp;type=0&amp;showTime=&amp;start=0&amp;limit=25
    
      当前时间毫秒数(从1970年1月1日（UTC/GMT的午夜）开始所经过的毫秒数):1462772665882
    
    组成的待签名字符串为：
    
      limit=25&amp;page=0&amp;size=25&amp;start=0&amp;type=0&amp;1462772665882
</code></pre>
<blockquote>
  <p>注意：</p>
  <blockquote>
    <p>没有值的参数无需传递，也无需包含到待签名数据中；</p>
    <p>待签名数据应该是原生值而不是URL Encoding之后的值。例如：调用某接口需要对请求参数email进行数字签名，那么待签名数据应该是email=test@msn.com，而不是email=test%40msn.com。</p>
  </blockquote>
</blockquote>
<ul>
  <li>使用MD5对待签名字符串进行加密，加密前进行加盐，加盐值为client_secret,待签名字符串为"UTF-8"编码。</li>
</ul>
<pre><code class="html">        假如client_secret为:alkdfjaso
    
        加盐算法 limit=25&amp;page=0&amp;size=25&amp;start=0&amp;type=0&amp;1462772665882{alkdfjaso}
    
        加密后值：96cf7db864ae65f3926b85f6d2d66d0b
</code></pre>
<ul>
  <li>将之前取的时间毫秒数(从1970年1月1日（UTC/GMT的午夜）开始所经过的毫秒数)及MD5加密后的字符串用“:”拼接并进行Base64编码，编码后的值为最终的签名值。</li>
</ul>
<pre><code class="html">        拼接字符串：1462772665882:96cf7db864ae65f3926b85f6d2d66d0b
    
        编码后：MTQ2Mjc3MjY2NTg4Mjo5NmNmN2RiODY0YWU2NWYzOTI2Yjg1ZjZkMmQ2NmQwYg==
</code></pre>
<ul>
  <li>后台将验证当前时间，10分钟以内的请求为有效请求。所以时间应取当前时间毫秒数(从1970年1月1日（UTC/GMT的午夜）开始所经过的毫秒数)，整个签名算法过程中时间应取统一值。</li>
</ul>
<h2><a href="#签名传递方式" name="签名传递方式">签名传递方式</a></h2>
<ul>
  <li>支持request.header、request.querystring、request.form等方式传递签名，签名参数名为："sign"。便于客户端缓存数据，推荐使用request.header方便传递。</li>
</ul>
<pre><code><br/>Accept: application/json;version=1.0.b
Accept-Language: zh-CN,en-US;q=0.5
Accept-Encoding: gzip, deflate
sign: MTQ2Mjc3MjY2NTg4Mjo5NmNmN2RiODY0YWU2NWYzOTI2Yjg1ZjZkMmQ2NmQwYg==

或

https://www.xxx.com?page=0&amp;size=25&amp;type=0&amp;showTime=&amp;start=0&amp;limit=25&amp;sign=MTQ2Mjc3MjY2NTg4Mjo5NmNmN2RiODY0YWU2NWYzOTI2Yjg1ZjZkMmQ2NmQwYg==
</code></pre>
<h2><a href="#值" name="值">值</a></h2>
<blockquote>
  <p>client_secret:QAZd37vdkiES0SBFr9gFIydHR1C2wxzZ</p>
</blockquote></div>
<div class="topAnchor">
  <a href="#">
    <span></span>
  </a>
</div>
</body>
</html>
